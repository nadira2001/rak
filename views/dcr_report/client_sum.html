{{extend 'layout_sample_report.html'}}

<html>

<head>

<script type="text/javascript">

function print_page()

  {

    window.print()

  }

</script>



</head>

<body>


<table width="900px;"> <tr><td style="text-align:right"><!--<a href="{{#=URL(c='report',f='downloadGoodsReceivedSummary',vars=dict(date_from=date_from,date_to=date_to,depot_id=depot_id,depot_name=depot_name,store_id=store_id,store_name=store_name,customer_id=customer_id,customer_name=customer_name,mso_id=mso_id,mso_name=mso_name))}}" >Downlaod</a>--></td></tr></table>



<table width="700px" cellspacing="1" cellpadding="1">

	<tr>

	  <td><table width="560" style="border:none;" >
		  <tr >
		    <td width="90" >YearMonth</td>
		    <td width="10" >:</td>
		    <td width="438" >{{=monthGet}}&nbsp;{{=yearGet}}</td>
	      </tr>
		  <tr >
		    <td >RSM</td>
		    <td >:</td>
		    <td ><span style="border-right-width:3px;">{{=rsm}}</span></td>
	      </tr>
		  <tr >
		    <td >FM</td>
		    <td >:</td>
		    <td ><span style="border-right-width:3px;">{{=fm}}
		      </span></td>
	      </tr>
		  <tr >
		    <td >TR</td>
		    <td >:</td>
		    <td ><span style="border-right-width:3px;">{{=tr}}</span></td>
	    </tr>
		  </table>
		
	    <table width="900px" style="border:none; text-align:center; font-weight:bold;" >
		    <tr >
		      <td width="100" >&nbsp;</td>
		      <td align="center" ><span style="border-bottom:1px solid #333;">Client Summary</span></td>
		      <td width="100" ><img  height="30px" src="{{=URL('static','images/comp_logo1.png')}}"/></td>
	        </tr>
      </table></td>

	</tr>

	<tr height="10px"></tr>

	<tr>

		<td><table width="900px" border="1" cellpadding="1" cellspacing="1" class="sample_border" >
		  <tr align="left" class="blackCatHead"  height="20px" ;>
		    
		    <td style="background-color:#FFC">Client</td>
            <td style="background-color:#FFC">ClientName</td>
            <td>01</td> <td>02</td><td>03</td><td>04</td>
            <td>05</td><td>06</td><td>07</td><td>08</td><td>09</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td>
            <td>15</td><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td><td>21</td><td>22</td><td>23</td><td>24</td>
            <td>25</td><td>26</td><td>27</td><td>28</td><td>29</td><td>30</td><td>31</td><td style="background-color:#FFC">Total</td>
	      </tr>
		  {{ p=0}} 		  
		  {{docCunt=0}}
          {{totalVisit=0}}
		  {{for i,record in enumerate(records):}}
          {{
             
             total=0
             d_1=' ';d_2=' ';d_3=' '; d_4=' '; d_5=' '; d_6=' '; d_7=' '; d_8=' '; d_9=' '; d_10=' '; d_11=' '; d_12=' ';  
             d_13=' '; d_14=' ';  d_15=' '; d_16=' '; d_17=' ';  d_18=' '; d_19=' '; d_20=' ';  d_21=' ';  d_22=' '; d_23=' '; 			             d_24=' ';d_25=' '; d_26=' '; d_27=' '; d_28=' ';d_29=' ';d_30=' ';d_31=' ';
             a_1=record.a_1; a_2=record.a_2; a_4=record.a_4; a_3=record.a_3; a_5=record.a_5; a_6=record.a_6;
             a_7=record.a_7; a_8=record.a_8; a_9=record.a_9; a_10=record.a_10;  a_11=record.a_11; a_12=record.a_12;
             a_13=record.a_13; a_14=record.a_14; a_15=record.a_15; a_16=record.a_16;  a_17=record.a_17; a_18=record.a_18;
             a_19=record.a_19; a_20=record.a_20; a_21=record.a_21;  a_22=record.a_22; a_23=record.a_23;  a_24=record.a_24;
             a_25=record.a_25; a_26=record.a_26; a_27=record.a_27; a_28=record.a_28;  a_29=record.a_29; 
             a_30=record.a_30; a_31=record.a_31;
             
             if record.a_1==None: a_1=0;  
             if record.a_2==None: a_2=0; 
             if record.a_3==None: a_3=0;
             if record.a_4==None: a_4=0; 
             if record.a_5==None: a_5=0;
             if record.a_6==None: a_6=0; 
             if record.a_7==None: a_7=0; 
             if record.a_8==None: a_8=0;
             if record.a_9==None: a_9=0; 
             if record.a_10==None: a_10=0;
             if record.a_11==None: a_11=0; 
             if record.a_12==None: a_12=0; 
             if record.a_13==None: a_13=0; 
             if record.a_14==None: a_14=0; 
             if record.a_15==None: a_15=0;
             if record.a_16==None: a_16=0; 
             if record.a_17==None: a_17=0; 
             if record.a_18==None: a_18=0;
             if record.a_19==None: a_19=0; 
             if record.a_20==None: a_20=0; 
             if record.a_21==None: a_21=0; 
             if record.a_22==None: a_22=0; 
             if record.a_23==None: a_23=0; 
             if record.a_24==None: a_24=0; 
             if record.a_25==None: a_25=0; 
             if record.a_26==None: a_26=0;
             if record.a_27==None: a_27=0; 
             if record.a_28==None: a_28=0;
             if record.a_29==None: a_29=0; 
             if record.a_30==None: a_30=0; 
             if record.a_31==None: a_31=0; 
             
     if int(record.d_1)>0: d_1='Y';docCunt=docCunt+1;
     if int(a_1)>0: d_1=str(a_1);total=total+int(a_1);totalVisit=totalVisit+int(a_1);
     if int(record.d_2)>0: d_2='Y';docCunt=docCunt+1;
     if int(a_2)>0: d_2=str(a_2);total=total+int(a_2);totalVisit=totalVisit+int(a_2);
     if int(record.d_3)>0: d_3='Y';docCunt=docCunt+1;
     if int(a_3)>0: d_3=str(a_3);total=total+int(a_3);totalVisit=totalVisit+int(a_3);
     if int(record.d_4)>0: d_4='Y';docCunt=docCunt+1;
     if int(a_4)>0: d_4=str(a_4);total=total+int(a_4);totalVisit=totalVisit+int(a_4);
     if int(record.d_5)>0: d_5='Y';docCunt=docCunt+1;
     if int(a_5)>0: d_5=str(a_5);total=total+int(a_5);totalVisit=totalVisit+int(a_5);
     if int(record.d_6)>0: d_6='Y';docCunt=docCunt+1;
     if int(a_6)>0: d_6=str(a_6);total=total+int(a_6);totalVisit=totalVisit+int(a_6);
     if int(record.d_7)>0: d_7='Y';docCunt=docCunt+1;
     if int(a_7)>0: d_7=str(a_7);total=total+int(a_7);totalVisit=totalVisit+int(a_7);
     if int(record.d_8)>0: d_8='Y';docCunt=docCunt+1;
     if int(a_8)>0: d_8=str(a_8);total=total+int(a_8);totalVisit=totalVisit+int(a_8);
     if int(record.d_9)>0: d_9='Y';docCunt=docCunt+1;
     if int(a_9)>0: d_9=str(a_9);total=total+int(a_9);totalVisit=totalVisit+int(a_9);
     if int(record.d_10)>0: d_10='Y';docCunt=docCunt+1;
     if int(a_10)>0: d_10=str(a_10);total=total+int(a_10);totalVisit=totalVisit+int(a_10);
     if int(record.d_11)>0: d_11='Y';docCunt=docCunt+1;
     if int(a_11)>0: d_11=str(a_11);total=total+int(a_11);totalVisit=totalVisit+int(a_11);
     if int(record.d_12)>0: d_12='Y';docCunt=docCunt+1;
     if int(a_12)>0: d_12=str(a_12);total=total+int(a_12);totalVisit=totalVisit+int(a_12);
     if int(record.d_13)>0: d_13='Y';docCunt=docCunt+1;
     if int(a_13)>0: d_13=str(a_13);total=total+int(a_13);totalVisit=totalVisit+int(a_13);
     if int(record.d_14)>0: d_14='Y';docCunt=docCunt+1;
     if int(a_14)>0: d_14=str(a_14);total=total+int(a_14);totalVisit=totalVisit+int(a_14);
     if int(record.d_15)>0: d_15='Y';docCunt=docCunt+1;
     if int(a_15)>0: d_15=str(a_15);total=total+int(a_15);totalVisit=totalVisit+int(a_15);
     if int(record.d_16)>0: d_16='Y';docCunt=docCunt+1;
     if int(a_16)>0: d_16=str(a_16);total=total+int(a_16);totalVisit=totalVisit+int(a_16);
     if int(record.d_17)>0: d_17='Y';docCunt=docCunt+1;
     if int(a_17)>0: d_17=str(a_17);total=total+int(a_17);totalVisit=totalVisit+int(a_17);
     if int(record.d_18)>0: d_18='Y';docCunt=docCunt+1;
     if int(a_18)>0: d_18=str(a_18);total=total+int(a_18);totalVisit=totalVisit+int(a_18);
     if int(record.d_19)>0: d_19='Y';docCunt=docCunt+1;
     if int(a_19)>0: d_19=str(a_19);total=total+int(a_19);totalVisit=totalVisit+int(a_19);
     if int(record.d_20)>0: d_20='Y';docCunt=docCunt+1;
     if int(a_20)>0: d_20=str(a_20);total=total+int(a_20);totalVisit=totalVisit+int(a_20);
     if int(record.d_21)>0: d_21='Y';docCunt=docCunt+1;
     if int(a_21)>0: d_21=str(a_21);total=total+int(a_21);totalVisit=totalVisit+int(a_21);
     if int(record.d_22)>0: d_22='Y';docCunt=docCunt+1;
     if int(a_22)>0: d_22=str(a_22);total=total+int(a_22);totalVisit=totalVisit+int(a_22);
     if int(record.d_23)>0: d_23='Y';docCunt=docCunt+1;
     if int(a_23)>0: d_23=str(a_23);total=total+int(a_23);totalVisit=totalVisit+int(a_23);
     if int(record.d_24)>0: d_24='Y';docCunt=docCunt+1;
     if int(a_24)>0: d_24=str(a_24);total=total+int(a_24);totalVisit=totalVisit+int(a_24);
     if int(record.d_25)>0: d_25='Y';docCunt=docCunt+1;
     if int(a_25)>0: d_25=str(a_25);total=total+int(a_25);totalVisit=totalVisit+int(a_25);
     if int(record.d_26)>0: d_26='Y';docCunt=docCunt+1;
     if int(a_26)>0: d_26=str(a_26);total=total+int(a_26);totalVisit=totalVisit+int(a_26);
     if int(record.d_27)>0: d_27='Y';docCunt=docCunt+1;
     if int(a_27)>0: d_27=str(a_27);total=total+int(a_27);totalVisit=totalVisit+int(a_27);
     if int(record.d_28)>0: d_28='Y';docCunt=docCunt+1;
     if int(a_28)>0: d_28=str(a_28);total=total+int(a_28);totalVisit=totalVisit+int(a_28);
     if int(record.d_29)>0: d_29='Y';docCunt=docCunt+1;
     if int(a_29)>0: d_29=str(a_29);total=total+int(a_29);totalVisit=totalVisit+int(a_29);
     if int(record.d_30)>0: d_30='Y';docCunt=docCunt+1;
     if int(a_30)>0: d_30str(a_30);total=total+int(a_30);totalVisit=totalVisit+int(a_30);
     if int(record.d_31)>0: d_31='Y';docCunt=docCunt+1;
     if int(a_31)>0: d_31=str(a_31);total=total+int(a_31);totalVisit=totalVisit+int(a_31);
            }} 
             <tr  align="left" class="blackCat"  style="vertical-align:middle; font-size:10px;">
             <td style="background-color:#FFC">{{=record.client_id}}</td>
            <td style="background-color:#FFC">{{=record.client_name}}</td>
            <td>{{=d_1}}</td>
            <td>{{=d_2}}</td>
            <td>{{=d_3}}</td>
            <td>{{=d_4}}</td>
            <td>{{=d_5}}</td>
            <td>{{=d_6}}</td>
            <td>{{=d_7}}</td>
            <td>{{=d_8}}</td>
            <td>{{=d_9}}</td>
            <td>{{=d_10}}</td>
            <td>{{=d_11}}</td>
            <td>{{=d_12}}</td>
            <td>{{=d_13}}</td>
            <td>{{=d_14}}</td>
            <td>{{=d_15}}</td>
            <td>{{=d_16}}</td>
            <td>{{=d_17}}</td>
            <td>{{=d_18}}</td>
            <td>{{=d_19}}</td>
            <td>{{=d_20}}</td>
            <td>{{=d_21}}</td>
            <td>{{=d_22}}</td>
            <td>{{=d_23}}</td>
            <td>{{=d_24}}</td>
            <td>{{=d_25}}</td>
            <td>{{=d_26}}</td>
            <td>{{=d_27}}</td>
            <td>{{=d_28}}</td>
            <td>{{=d_29}}</td>
            <td>{{=d_30}}</td>
            <td>{{=d_31}}</td>
          
  
		    
            
            <td style="background-color:#FFC">{{=total}}</td>
  </tr>
		  {{pass}}
          
          
          {{ for x in range(len(recordDoc)): 
              recordD=recordDoc[x]   }}
             
           {{#for i,recordD in enumerate(recordDoc):}}
            <tr  align="left" class="blackCat"  style="vertical-align:middle; font-size:10px;">
            <td style="background-color:#FFC">{{=recordD["client_id"]}}</td>
            <td style="background-color:#FFC">{{=recordD["name"]}}</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          
  
		    
            
            <td style="background-color:#FFC">0</td>
  </tr>
		  {{pass}}   
          
          <font style="font-size:14px; color:#004080">Number Clients in this territory: </font><font style="font-size:14px; color:#B70060">{{=docTr}}</font><br>
          <font style="font-size:14px; color:#004080">Number Clients visited in this territory: </font><font style="font-size:14px; color:#B70060">{{=docCunt}}</font><br>
          <font style="font-size:14px; color:#004080">Total Amount of Client Visit: </font><font style="font-size:14px; color:#B70060">{{=totalVisit}}</font>
	  </table>		  <br></td>

			

	</tr>

</table>

<br/>




<br/>



</body>

</html>

